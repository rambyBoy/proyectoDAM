<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="../libs/onsen/css/onsenui.css">
  <link rel="stylesheet" href="../libs/onsen/css/onsen-css-components.min.css">
  <link rel="stylesheet" href="../libs/onsen/css/material-design-iconic-font/css/material-design-iconic-font.min.css">
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <title>Encuestas.</title>
</head>

<body>

  <ons-page>
    <ons-toolbar>
      <div class="left">
        <ons-back-button id="back-button">Atras</ons-back-button>
      </div>
      <div class="center">Graficas de encuestas</div>
      <!--<div class="right">-->
      <!--<ons-toolbar-button>-->
      <!--<ons-icon icon="md-menu"></ons-icon>-->
      <!--</ons-toolbar-button>-->
      <!--</div>-->
    </ons-toolbar>

    <div id="survey">

    </div>


  </ons-page>
  <script src="../libs/onsen/js/onsenui.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.5.7/firebase.js"></script>
  <script src="../js/firebase.js"></script>
  <script>
    var db = firebase.firestore();

    db.settings({
      timestampsInSnapshots: true
    });

    db.collection("surveys").get().then(function (querySnapshot) {
      querySnapshot.forEach(function (doc) {

        let survey = document.getElementById("survey");

        let card = document.createElement("ons-card");
        let title = document.createElement("div");
        let content = document.createElement("div");

        card.classList.add('ons-card');


        title.innerHTML = "<h2>" + doc.data().title + "</h2>";

        content.innerHTML += "<ons-list-header>" + "Descripci√≥n: " + doc.data().description + "</ons-list-header>"
          + "<ons-list-item>" + "Dependencia: " + doc.data().dependence + "</ons-list-item>";

        let button = document.createElement('ons-button')
        button.innerHTML = "Ver grafica"
        button.setAttribute('id', 'iddd')

        button.addEventListener('click', function () {
          localStorage.setItem('graph', this.getAttribute('id'));
          
          window.location.href = "ramby.html"
        })

        content.append(button)

        card.append(title, content);
        survey.appendChild(card);
      });
    })

    let back_button = document.getElementById("back-button")
    back_button.addEventListener('click', function () {
      window.history.back()
    })
  </script>
</body>

</html>